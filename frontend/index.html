<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Smart Airbag Alert System</title>
  <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=DM+Sans:wght@400;500;600&display=swap" rel="stylesheet"/>
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    :root {
      --red: #e8001c; --red-glow: rgba(232,0,28,0.35);
      --bg: #0a0a0b; --surface: #141416; --border: #242428;
      --text: #f0f0f0; --muted: #888;
    }
    body {
      background: var(--bg); color: var(--text);
      font-family: 'DM Sans', sans-serif; min-height: 100vh;
      display: flex; flex-direction: column; align-items: center;
      justify-content: center; padding: 2rem 1rem; overflow-x: hidden;
    }
    body::before {
      content: ''; position: fixed; top: -20%; left: 50%;
      transform: translateX(-50%); width: 700px; height: 400px;
      background: radial-gradient(ellipse, rgba(200,0,20,0.12) 0%, transparent 70%);
      pointer-events: none; z-index: 0;
    }
    .card {
      background: var(--surface); border: 1px solid var(--border);
      border-radius: 16px; padding: 2.5rem 2.5rem 2rem;
      width: 100%; max-width: 480px; position: relative; z-index: 1;
      box-shadow: 0 0 60px rgba(0,0,0,0.6), 0 0 0 1px rgba(255,255,255,0.04) inset;
    }
    .badge {
      display: inline-flex; align-items: center; gap: 6px;
      background: rgba(232,0,28,0.12); border: 1px solid rgba(232,0,28,0.3);
      color: var(--red); font-size: 0.7rem; font-weight: 600;
      letter-spacing: 0.12em; text-transform: uppercase;
      padding: 4px 12px; border-radius: 99px; margin-bottom: 1.2rem;
    }
    .badge::before {
      content: ''; width: 6px; height: 6px; border-radius: 50%;
      background: var(--red); animation: pulse 1.4s ease-in-out infinite;
    }
    @keyframes pulse { 0%,100%{opacity:1;transform:scale(1)} 50%{opacity:0.4;transform:scale(0.7)} }
    h1 { font-family:'Bebas Neue',sans-serif; font-size:2.6rem; letter-spacing:0.04em; line-height:1; margin-bottom:0.4rem; color:#fff; }
    h1 span { color: var(--red); }
    .subtitle { font-size:0.85rem; color:var(--muted); margin-bottom:2rem; line-height:1.5; }
    .divider { border:none; border-top:1px solid var(--border); margin-bottom:1.8rem; }

    /* Login */
    #loginSection { display:flex; flex-direction:column; align-items:center; gap:1rem; padding:1.5rem 0 0.5rem; }
    .lock-icon { font-size:2.5rem; margin-bottom:0.3rem; }
    .login-msg { font-size:0.9rem; color:var(--muted); text-align:center; }
    .btn-google {
      display:flex; align-items:center; gap:12px; background:#fff; color:#1f1f1f;
      border:none; border-radius:8px; padding:0.75rem 1.5rem;
      font-family:'DM Sans',sans-serif; font-size:0.95rem; font-weight:600;
      cursor:pointer; transition:box-shadow 0.2s,transform 0.1s;
      box-shadow:0 2px 12px rgba(0,0,0,0.3); margin-top:0.5rem;
    }
    .btn-google:hover { box-shadow:0 4px 20px rgba(0,0,0,0.45); transform:translateY(-1px); }
    .btn-google img { width:20px; height:20px; }

    /* User bar */
    #userBar {
      display:none; align-items:center; justify-content:space-between;
      background:rgba(255,255,255,0.04); border:1px solid var(--border);
      border-radius:8px; padding:0.6rem 1rem; margin-bottom:1.5rem; font-size:0.82rem;
    }
    #userBar .user-info { display:flex; align-items:center; gap:8px; color:#ccc; }
    #userBar img { width:26px; height:26px; border-radius:50%; }
    #userBar .btn-signout {
      background:none; border:1px solid var(--border); color:var(--muted);
      border-radius:6px; padding:3px 10px; font-size:0.75rem; cursor:pointer;
      font-family:'DM Sans',sans-serif; transition:border-color 0.2s,color 0.2s;
    }
    #userBar .btn-signout:hover { border-color:var(--red); color:var(--red); }

    /* Form */
    #formSection { display:none; }
    .form-grid { display:grid; grid-template-columns:1fr 1fr; gap:1rem; margin-bottom:1.4rem; }
    .field { display:flex; flex-direction:column; gap:6px; }
    .field.full { grid-column:1/-1; }
    label { font-size:0.72rem; font-weight:600; letter-spacing:0.09em; text-transform:uppercase; color:var(--muted); }
    input {
      background:rgba(255,255,255,0.04); border:1px solid var(--border);
      border-radius:8px; padding:0.65rem 0.9rem; color:var(--text);
      font-family:'DM Sans',sans-serif; font-size:0.9rem; outline:none;
      transition:border-color 0.2s,box-shadow 0.2s;
    }
    input::placeholder { color:#444; }
    input:focus { border-color:rgba(232,0,28,0.5); box-shadow:0 0 0 3px rgba(232,0,28,0.1); }
    .btn-simulate {
      width:100%; background:var(--red); color:#fff; border:none;
      border-radius:10px; padding:1rem; font-family:'Bebas Neue',sans-serif;
      font-size:1.3rem; letter-spacing:0.1em; cursor:pointer; position:relative;
      overflow:hidden; transition:background 0.2s,transform 0.1s,box-shadow 0.2s;
      box-shadow:0 4px 20px var(--red-glow); margin-top:0.4rem;
    }
    .btn-simulate:hover { background:#ff0d28; box-shadow:0 6px 30px rgba(232,0,28,0.55); }
    .btn-simulate:active { transform:scale(0.98); }
    .btn-simulate:disabled { background:#5a0010; cursor:not-allowed; box-shadow:none; }
    .btn-simulate .ripple {
      position:absolute; border-radius:50%; transform:scale(0);
      animation:ripple 0.5s linear; background:rgba(255,255,255,0.25); pointer-events:none;
    }
    @keyframes ripple { to{transform:scale(4);opacity:0} }
    .status {
      margin-top:1rem; border-radius:8px; padding:0.8rem 1rem;
      font-size:0.85rem; font-weight:500; display:none; align-items:center; gap:8px;
    }
    .status.success { display:flex; background:rgba(0,200,80,0.1); border:1px solid rgba(0,200,80,0.25); color:#3ddc84; }
    .status.error { display:flex; background:rgba(232,0,28,0.1); border:1px solid rgba(232,0,28,0.3); color:#ff6b7a; }
    .flash-overlay { position:fixed; inset:0; background:var(--red); opacity:0; pointer-events:none; z-index:999; }
    .flash-overlay.active { animation:crash-flash 0.6s ease-out forwards; }
    @keyframes crash-flash { 0%{opacity:0.7} 100%{opacity:0} }
    footer { margin-top:1.5rem; font-size:0.72rem; color:#444; text-align:center; z-index:1; }
  </style>
</head>
<body>
<div class="flash-overlay" id="flashOverlay"></div>
<div class="card">
  <div class="badge">Live System Demo</div>
  <h1>Smart Airbag<br/><span>Alert System</span></h1>
  <p class="subtitle">Simulates a crash event and dispatches an SMS alert via Twilio to emergency contacts.</p>
  <hr class="divider"/>

  <div id="loginSection">
    <div class="lock-icon">ðŸ”’</div>
    <p class="login-msg">Sign in to access the airbag alert system</p>
    <button class="btn-google" onclick="signInWithGoogle()">
      <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" alt="Google"/>
      Sign in with Google
    </button>
  </div>

  <div id="userBar">
    <div class="user-info">
      <img id="userPhoto" src="" alt=""/>
      <span id="userName"></span>
    </div>
    <button class="btn-signout" onclick="signOut()">Sign Out</button>
  </div>

  <div id="formSection">
    <div class="form-grid">
      <div class="field full">
        <label>Owner Name</label>
        <input type="text" id="ownerName" placeholder="e.g. Arjun Sharma"/>
      </div>
      <div class="field full">
        <label>Phone Number</label>
        <input type="tel" id="phoneNumber" placeholder="+91 98765 43210"/>
      </div>
      <div class="field">
        <label>Car Model</label>
        <input type="text" id="carModel" placeholder="e.g. Swift Dzire"/>
      </div>
      <div class="field">
        <label>Vehicle Number</label>
        <input type="text" id="vehicleNumber" placeholder="e.g. TN09AZ1234"/>
      </div>
    </div>
    <button class="btn-simulate" id="simulateBtn" onclick="handleSimulate(event)">
      âš  Simulate Airbag Deployment
    </button>
    <div class="status" id="statusBox">
      <span id="statusIcon"></span>
      <span id="statusText"></span>
    </div>
  </div>
</div>
<footer>Smart Airbag Alert System â€” Demo Build Â· Powered by Twilio & Firebase</footer>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
  import { getAuth, GoogleAuthProvider, signInWithPopup, signOut as fbSignOut, onAuthStateChanged }
    from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";

  // ðŸ”´ Replace with your Firebase config

const firebaseConfig = {
  apiKey: "AIzaSyBd5AjDJkg7yy_93COr0J8eNN9BZV99WF0",
  authDomain: "air-bag-e0bb8.firebaseapp.com",
  projectId: "air-bag-e0bb8",
  storageBucket: "air-bag-e0bb8.firebasestorage.app",
  messagingSenderId: "66546683534",
  appId: "1:66546683534:web:37386f163ecd8e92aec3df"
};

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const provider = new GoogleAuthProvider();

  onAuthStateChanged(auth, (user) => {
    if (user) {
      document.getElementById('loginSection').style.display = 'none';
      document.getElementById('userBar').style.display = 'flex';
      document.getElementById('formSection').style.display = 'block';
      document.getElementById('userName').textContent = user.displayName;
      document.getElementById('userPhoto').src = user.photoURL;
      document.getElementById('ownerName').value = user.displayName;
    } else {
      document.getElementById('loginSection').style.display = 'flex';
      document.getElementById('userBar').style.display = 'none';
      document.getElementById('formSection').style.display = 'none';
    }
  });

  window.signInWithGoogle = async () => {
    try { await signInWithPopup(auth, provider); }
    catch (err) { alert('Sign-in failed: ' + err.message); }
  };

  window.signOut = async () => { await fbSignOut(auth); };
</script>

<script>
  async function handleSimulate(e) {
    const btn = document.getElementById('simulateBtn');
    const circle = document.createElement('span');
    const diameter = Math.max(btn.clientWidth, btn.clientHeight);
    const rect = btn.getBoundingClientRect();
    circle.style.cssText = `width:${diameter}px;height:${diameter}px;left:${e.clientX-rect.left-diameter/2}px;top:${e.clientY-rect.top-diameter/2}px`;
    circle.classList.add('ripple');
    btn.querySelector('.ripple')?.remove();
    btn.appendChild(circle);

    const ownerName     = document.getElementById('ownerName').value.trim();
    const phoneNumber   = document.getElementById('phoneNumber').value.trim();
    const carModel      = document.getElementById('carModel').value.trim();
    const vehicleNumber = document.getElementById('vehicleNumber').value.trim();

    if (!ownerName || !phoneNumber || !carModel || !vehicleNumber) {
      showStatus('error','âœ•','Please fill in all fields before simulating.'); return;
    }

    const overlay = document.getElementById('flashOverlay');
    overlay.classList.remove('active'); void overlay.offsetWidth; overlay.classList.add('active');

    btn.disabled = true; btn.textContent = 'Sending Alertâ€¦'; clearStatus();

    try {
      const res = await fetch('http://localhost:3000/simulate-crash', {
        method:'POST', headers:{'Content-Type':'application/json'},
        body: JSON.stringify({ ownerName, phoneNumber, carModel, vehicleNumber })
      });
      const data = await res.json();
      if (data.success) showStatus('success','âœ“', data.message);
      else showStatus('error','âœ•', data.message);
    } catch (err) {
      showStatus('error','âœ•','Could not reach server. Is the backend running on port 3000?');
    } finally {
      btn.disabled = false; btn.textContent = 'âš  Simulate Airbag Deployment';
    }
  }

  function showStatus(type, icon, text) {
    const box = document.getElementById('statusBox');
    box.className = 'status ' + type;
    document.getElementById('statusIcon').textContent = icon;
    document.getElementById('statusText').textContent = text;
  }
  function clearStatus() { document.getElementById('statusBox').className = 'status'; }
</script>
</body>
</html>
